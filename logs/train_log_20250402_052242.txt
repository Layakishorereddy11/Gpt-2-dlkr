[2025-04-02 05:22:42] Checkpointing enabled.
[2025-04-02 05:22:42] Using device: mps
[2025-04-02 05:23:11] step    0 | loss: 9.246778 | lr: 6.0000e-05 | norm: 14.8640 | dt: 29691.43ms | tok/sec: 8828.95
[2025-04-02 05:23:12] Validation loss at step 0: 8.503489
[2025-04-02 05:23:13] New best model saved at checkpoints/run_20250402_052242/best/model_step_0.pt
[2025-04-02 05:23:14] Sample responses at step 0:
[2025-04-02 05:23:14] e4 e5 Rexa3 Qhxc8+ Q6d4 Rfd6+ Rxg8 Rhxh5# dxc2+ R3xc6+ Qef7+ Q8a7 N1xf2 exd1=N+ Be5# R8xg2# Nhg8 b7+ Q8xc3
[2025-04-02 05:23:14] e4 e5 Rbh3 Nhg8 Qch2# Rdxg7 Bc1# Qaxg5 Qfxc4+ Rc3# Q2d5 Rhxh5# R2c5# Qe4 Rcg8 N5b6 Bxc7+ Rbxg7 Rbxe1
[2025-04-02 05:23:15] Saved checkpoint at checkpoints/run_20250402_052242/regular/model_step_0.pt
[2025-04-02 05:23:43] step    1 | loss: 8.371329 | lr: 1.2000e-04 | norm: 9.9123 | dt: 27501.31ms | tok/sec: 9532.05
[2025-04-02 05:24:09] step    2 | loss: 7.772850 | lr: 1.8000e-04 | norm: 7.3061 | dt: 26407.11ms | tok/sec: 9927.02
[2025-04-02 05:24:36] step    3 | loss: 7.321418 | lr: 2.4000e-04 | norm: 6.7653 | dt: 27121.61ms | tok/sec: 9665.50
[2025-04-02 05:25:03] step    4 | loss: 7.097468 | lr: 3.0000e-04 | norm: 6.5950 | dt: 26891.99ms | tok/sec: 9748.03
[2025-04-02 05:25:30] step    5 | loss: 7.012001 | lr: 3.6000e-04 | norm: 6.4416 | dt: 27046.28ms | tok/sec: 9692.42
[2025-04-02 05:25:57] step    6 | loss: 6.868489 | lr: 4.2000e-04 | norm: 6.5254 | dt: 27133.39ms | tok/sec: 9661.31
[2025-04-02 05:26:25] step    7 | loss: 6.764187 | lr: 4.8000e-04 | norm: 6.3996 | dt: 27610.42ms | tok/sec: 9494.39
[2025-04-02 05:26:52] step    8 | loss: 6.617018 | lr: 5.4000e-04 | norm: 6.3373 | dt: 26999.82ms | tok/sec: 9709.10
[2025-04-02 05:27:19] step    9 | loss: 6.370659 | lr: 6.0000e-04 | norm: 6.5044 | dt: 27252.91ms | tok/sec: 9618.94
[2025-04-02 05:27:46] step   10 | loss: 6.207931 | lr: 6.0000e-04 | norm: 6.3563 | dt: 27217.99ms | tok/sec: 9631.28
[2025-04-02 05:28:14] step   11 | loss: 5.980798 | lr: 5.9998e-04 | norm: 6.4130 | dt: 27547.47ms | tok/sec: 9516.08
[2025-04-02 05:28:41] step   12 | loss: 5.852304 | lr: 5.9991e-04 | norm: 6.1626 | dt: 27367.58ms | tok/sec: 9578.63
[2025-04-02 05:29:08] step   13 | loss: 5.647867 | lr: 5.9979e-04 | norm: 6.1662 | dt: 27191.00ms | tok/sec: 9640.84
[2025-04-02 05:29:36] step   14 | loss: 5.457335 | lr: 5.9963e-04 | norm: 6.1350 | dt: 27984.19ms | tok/sec: 9367.58
[2025-04-02 05:30:04] step   15 | loss: 5.328231 | lr: 5.9942e-04 | norm: 5.9763 | dt: 27704.97ms | tok/sec: 9461.98
[2025-04-02 05:30:32] step   16 | loss: 5.153542 | lr: 5.9917e-04 | norm: 5.8486 | dt: 27698.35ms | tok/sec: 9464.24
[2025-04-02 05:31:00] step   17 | loss: 5.039531 | lr: 5.9887e-04 | norm: 5.6142 | dt: 28334.20ms | tok/sec: 9251.86
[2025-04-02 05:31:28] step   18 | loss: 4.890835 | lr: 5.9852e-04 | norm: 5.5806 | dt: 28025.96ms | tok/sec: 9353.61
[2025-04-02 05:31:56] step   19 | loss: 4.754370 | lr: 5.9813e-04 | norm: 5.3284 | dt: 27854.23ms | tok/sec: 9411.28
[2025-04-02 05:32:24] step   20 | loss: 4.653046 | lr: 5.9769e-04 | norm: 5.0628 | dt: 28155.33ms | tok/sec: 9310.64
[2025-04-02 05:32:51] step   21 | loss: 4.537679 | lr: 5.9721e-04 | norm: 4.9217 | dt: 27345.51ms | tok/sec: 9586.37
[2025-04-02 05:33:19] step   22 | loss: 4.397772 | lr: 5.9668e-04 | norm: 4.6947 | dt: 27851.45ms | tok/sec: 9412.22
[2025-04-02 05:33:47] step   23 | loss: 4.319376 | lr: 5.9610e-04 | norm: 4.3970 | dt: 27955.56ms | tok/sec: 9377.17
[2025-04-02 05:34:15] step   24 | loss: 4.232862 | lr: 5.9548e-04 | norm: 4.1248 | dt: 27771.22ms | tok/sec: 9439.41
[2025-04-02 05:34:43] step   25 | loss: 4.137208 | lr: 5.9481e-04 | norm: 3.8121 | dt: 27928.18ms | tok/sec: 9386.36
[2025-04-02 05:35:11] step   26 | loss: 4.088467 | lr: 5.9410e-04 | norm: 3.5093 | dt: 27563.63ms | tok/sec: 9510.50
[2025-04-02 05:35:39] step   27 | loss: 4.033821 | lr: 5.9334e-04 | norm: 3.1595 | dt: 28601.32ms | tok/sec: 9165.45
[2025-04-02 05:36:06] step   28 | loss: 3.960845 | lr: 5.9254e-04 | norm: 2.8276 | dt: 27087.29ms | tok/sec: 9677.75
[2025-04-02 05:36:33] step   29 | loss: 3.939754 | lr: 5.9169e-04 | norm: 2.4289 | dt: 27043.39ms | tok/sec: 9693.46
[2025-04-02 05:37:00] step   30 | loss: 3.913481 | lr: 5.9080e-04 | norm: 2.0799 | dt: 26539.77ms | tok/sec: 9877.40
[2025-04-02 05:37:27] step   31 | loss: 3.825320 | lr: 5.8986e-04 | norm: 1.8807 | dt: 26859.19ms | tok/sec: 9759.94
[2025-04-02 05:37:54] step   32 | loss: 3.758614 | lr: 5.8888e-04 | norm: 1.6076 | dt: 27141.36ms | tok/sec: 9658.47
[2025-04-02 05:38:22] step   33 | loss: 3.782050 | lr: 5.8786e-04 | norm: 1.9973 | dt: 27994.91ms | tok/sec: 9363.99
[2025-04-02 05:38:50] step   34 | loss: 3.762532 | lr: 5.8679e-04 | norm: 1.1778 | dt: 28106.61ms | tok/sec: 9326.78
[2025-04-02 05:39:18] step   35 | loss: 3.751751 | lr: 5.8567e-04 | norm: 1.0201 | dt: 28023.04ms | tok/sec: 9354.59
[2025-04-02 05:39:46] step   36 | loss: 3.650561 | lr: 5.8451e-04 | norm: 0.9260 | dt: 27915.25ms | tok/sec: 9390.71
[2025-04-02 05:40:14] step   37 | loss: 3.691797 | lr: 5.8331e-04 | norm: 0.6912 | dt: 28068.23ms | tok/sec: 9339.53
[2025-04-02 05:40:42] step   38 | loss: 3.629617 | lr: 5.8207e-04 | norm: 0.5840 | dt: 27703.03ms | tok/sec: 9462.65
[2025-04-02 05:41:10] step   39 | loss: 3.659483 | lr: 5.8078e-04 | norm: 0.9606 | dt: 28066.23ms | tok/sec: 9340.19
[2025-04-02 05:41:38] step   40 | loss: 3.656528 | lr: 5.7945e-04 | norm: 0.7763 | dt: 28179.08ms | tok/sec: 9302.79
[2025-04-02 05:42:06] step   41 | loss: 3.660259 | lr: 5.7807e-04 | norm: 0.4749 | dt: 27778.62ms | tok/sec: 9436.90
[2025-04-02 05:42:34] step   42 | loss: 3.601382 | lr: 5.7666e-04 | norm: 0.4999 | dt: 28055.22ms | tok/sec: 9343.86
[2025-04-02 05:43:01] step   43 | loss: 3.623758 | lr: 5.7520e-04 | norm: 0.5481 | dt: 27614.53ms | tok/sec: 9492.97
[2025-04-02 05:43:29] step   44 | loss: 3.535190 | lr: 5.7370e-04 | norm: 0.3478 | dt: 28047.01ms | tok/sec: 9346.60
[2025-04-02 05:43:58] step   45 | loss: 3.563548 | lr: 5.7216e-04 | norm: 0.2856 | dt: 28207.30ms | tok/sec: 9293.48
[2025-04-02 05:44:26] step   46 | loss: 3.571053 | lr: 5.7057e-04 | norm: 0.2922 | dt: 27964.53ms | tok/sec: 9374.16
[2025-04-02 05:44:53] step   47 | loss: 3.586746 | lr: 5.6895e-04 | norm: 0.2439 | dt: 27845.63ms | tok/sec: 9414.19
[2025-04-02 05:45:22] step   48 | loss: 3.658410 | lr: 5.6728e-04 | norm: 0.2452 | dt: 28047.44ms | tok/sec: 9346.45
[2025-04-02 05:45:49] step   49 | loss: 3.520032 | lr: 5.6557e-04 | norm: 0.1797 | dt: 27696.77ms | tok/sec: 9464.79
[2025-04-02 05:46:18] step   50 | loss: 3.496981 | lr: 5.6383e-04 | norm: 0.1999 | dt: 28766.00ms | tok/sec: 9112.98
[2025-04-02 05:46:46] step   51 | loss: 3.405793 | lr: 5.6204e-04 | norm: 0.2037 | dt: 27800.26ms | tok/sec: 9429.55
[2025-04-02 05:47:14] step   52 | loss: 3.497556 | lr: 5.6021e-04 | norm: 0.1796 | dt: 27804.29ms | tok/sec: 9428.19
[2025-04-02 05:47:42] step   53 | loss: 3.459324 | lr: 5.5835e-04 | norm: 0.1841 | dt: 27904.37ms | tok/sec: 9394.37
[2025-04-02 05:48:09] step   54 | loss: 3.382112 | lr: 5.5644e-04 | norm: 0.1632 | dt: 27646.44ms | tok/sec: 9482.02
[2025-04-02 05:48:38] step   55 | loss: 3.416918 | lr: 5.5450e-04 | norm: 0.1587 | dt: 28407.18ms | tok/sec: 9228.09
[2025-04-02 05:49:05] step   56 | loss: 3.392519 | lr: 5.5251e-04 | norm: 0.1526 | dt: 27603.85ms | tok/sec: 9496.65
[2025-04-02 05:49:33] step   57 | loss: 3.433897 | lr: 5.5049e-04 | norm: 0.1694 | dt: 27902.23ms | tok/sec: 9395.09
[2025-04-02 05:50:01] step   58 | loss: 3.379448 | lr: 5.4843e-04 | norm: 0.1425 | dt: 27749.62ms | tok/sec: 9446.76
[2025-04-02 05:50:29] step   59 | loss: 3.400452 | lr: 5.4634e-04 | norm: 0.1393 | dt: 28138.91ms | tok/sec: 9316.07
[2025-04-02 05:50:58] step   60 | loss: 3.433190 | lr: 5.4421e-04 | norm: 0.1809 | dt: 29073.55ms | tok/sec: 9016.58
[2025-04-02 05:51:26] step   61 | loss: 3.354216 | lr: 5.4204e-04 | norm: 0.1989 | dt: 28197.48ms | tok/sec: 9296.72
[2025-04-02 05:51:54] step   62 | loss: 3.372733 | lr: 5.3983e-04 | norm: 0.1207 | dt: 28108.87ms | tok/sec: 9326.02
[2025-04-02 05:52:22] step   63 | loss: 3.384730 | lr: 5.3759e-04 | norm: 0.2952 | dt: 28080.79ms | tok/sec: 9335.35
[2025-04-02 05:52:50] step   64 | loss: 3.341802 | lr: 5.3531e-04 | norm: 0.2084 | dt: 27553.29ms | tok/sec: 9514.07
[2025-04-02 05:53:18] step   65 | loss: 3.305589 | lr: 5.3300e-04 | norm: 0.3399 | dt: 27843.00ms | tok/sec: 9415.08
[2025-04-02 05:53:46] step   66 | loss: 3.314881 | lr: 5.3065e-04 | norm: 0.4117 | dt: 27688.92ms | tok/sec: 9467.47
[2025-04-02 05:54:13] step   67 | loss: 3.326884 | lr: 5.2827e-04 | norm: 0.2547 | dt: 27542.11ms | tok/sec: 9517.94
[2025-04-02 05:54:41] step   68 | loss: 3.290141 | lr: 5.2585e-04 | norm: 0.1367 | dt: 27845.99ms | tok/sec: 9414.07
[2025-04-02 05:55:09] step   69 | loss: 3.328505 | lr: 5.2340e-04 | norm: 0.2540 | dt: 27512.92ms | tok/sec: 9528.03
[2025-04-02 05:55:37] step   70 | loss: 3.309437 | lr: 5.2092e-04 | norm: 0.1779 | dt: 28150.40ms | tok/sec: 9312.27
[2025-04-02 05:56:04] step   71 | loss: 3.371992 | lr: 5.1840e-04 | norm: 0.1350 | dt: 27780.29ms | tok/sec: 9436.33
[2025-04-02 05:56:33] step   72 | loss: 3.293308 | lr: 5.1586e-04 | norm: 0.1934 | dt: 28093.87ms | tok/sec: 9331.00
[2025-04-02 05:57:00] step   73 | loss: 3.322038 | lr: 5.1328e-04 | norm: 0.1360 | dt: 27653.24ms | tok/sec: 9479.68
[2025-04-02 05:57:28] step   74 | loss: 3.286084 | lr: 5.1067e-04 | norm: 0.0877 | dt: 27890.74ms | tok/sec: 9398.96
[2025-04-02 05:57:56] step   75 | loss: 3.241292 | lr: 5.0802e-04 | norm: 0.1666 | dt: 27745.84ms | tok/sec: 9448.05
[2025-04-02 05:58:25] step   76 | loss: 3.255371 | lr: 5.0535e-04 | norm: 0.2122 | dt: 29131.66ms | tok/sec: 8998.59
[2025-04-02 05:58:53] step   77 | loss: 3.261215 | lr: 5.0265e-04 | norm: 0.2263 | dt: 28048.15ms | tok/sec: 9346.21
[2025-04-02 05:59:21] step   78 | loss: 3.201389 | lr: 4.9992e-04 | norm: 0.2215 | dt: 27971.18ms | tok/sec: 9371.93
[2025-04-02 05:59:49] step   79 | loss: 3.258478 | lr: 4.9716e-04 | norm: 0.2230 | dt: 27705.37ms | tok/sec: 9461.85
[2025-04-02 06:00:17] step   80 | loss: 3.283241 | lr: 4.9437e-04 | norm: 0.1876 | dt: 28345.18ms | tok/sec: 9248.27
[2025-04-02 06:00:45] step   81 | loss: 3.278876 | lr: 4.9155e-04 | norm: 0.1927 | dt: 27656.07ms | tok/sec: 9478.71
[2025-04-02 06:01:13] step   82 | loss: 3.210479 | lr: 4.8870e-04 | norm: 0.2178 | dt: 27998.82ms | tok/sec: 9362.68
[2025-04-02 06:01:41] step   83 | loss: 3.268209 | lr: 4.8583e-04 | norm: 0.3019 | dt: 28070.88ms | tok/sec: 9338.65
[2025-04-02 06:02:09] step   84 | loss: 3.277887 | lr: 4.8293e-04 | norm: 0.5386 | dt: 27690.42ms | tok/sec: 9466.96
[2025-04-02 06:02:40] step   85 | loss: 3.253044 | lr: 4.8000e-04 | norm: 0.6871 | dt: 31899.05ms | tok/sec: 8217.93
[2025-04-02 06:03:08] step   86 | loss: 3.257575 | lr: 4.7705e-04 | norm: 0.5232 | dt: 27525.96ms | tok/sec: 9523.52
[2025-04-02 06:03:36] step   87 | loss: 3.219016 | lr: 4.7408e-04 | norm: 0.6286 | dt: 28385.84ms | tok/sec: 9235.03
[2025-04-02 06:04:04] step   88 | loss: 3.218722 | lr: 4.7107e-04 | norm: 0.6323 | dt: 27789.17ms | tok/sec: 9433.31
[2025-04-02 06:04:32] step   89 | loss: 3.244190 | lr: 4.6805e-04 | norm: 0.2765 | dt: 27906.18ms | tok/sec: 9393.76
[2025-04-02 06:05:00] step   90 | loss: 3.246080 | lr: 4.6500e-04 | norm: 0.5278 | dt: 27663.43ms | tok/sec: 9476.19
[2025-04-02 06:05:28] step   91 | loss: 3.252989 | lr: 4.6193e-04 | norm: 0.2917 | dt: 27849.32ms | tok/sec: 9412.94
[2025-04-02 06:05:56] step   92 | loss: 3.161315 | lr: 4.5883e-04 | norm: 0.3586 | dt: 28887.69ms | tok/sec: 9074.59
[2025-04-02 06:06:25] step   93 | loss: 3.182796 | lr: 4.5572e-04 | norm: 0.2470 | dt: 28990.99ms | tok/sec: 9042.26
[2025-04-02 06:06:53] step   94 | loss: 3.198279 | lr: 4.5258e-04 | norm: 0.3816 | dt: 27941.58ms | tok/sec: 9381.86
[2025-04-02 06:07:22] step   95 | loss: 3.194373 | lr: 4.4942e-04 | norm: 0.2274 | dt: 28715.18ms | tok/sec: 9129.11
[2025-04-02 06:07:50] step   96 | loss: 3.207368 | lr: 4.4624e-04 | norm: 0.3084 | dt: 27920.89ms | tok/sec: 9388.81
[2025-04-02 06:08:18] step   97 | loss: 3.167707 | lr: 4.4304e-04 | norm: 0.3787 | dt: 28032.09ms | tok/sec: 9351.57
[2025-04-02 06:08:46] step   98 | loss: 3.162646 | lr: 4.3982e-04 | norm: 0.2467 | dt: 27891.30ms | tok/sec: 9398.77
[2025-04-02 06:09:14] step   99 | loss: 3.224898 | lr: 4.3658e-04 | norm: 0.2432 | dt: 27981.16ms | tok/sec: 9368.59
[2025-04-02 06:09:42] step  100 | loss: 3.194439 | lr: 4.3332e-04 | norm: 0.2210 | dt: 27880.90ms | tok/sec: 9402.28
[2025-04-02 06:09:43] Validation loss at step 100: 3.477204
[2025-04-02 06:09:44] New best model saved at checkpoints/run_20250402_052242/best/model_step_100.pt
[2025-04-02 06:09:44] Sample responses at step 100:
[2025-04-02 06:09:44] e4 e5 Bb5 Nf6 Bb5 c5 a4 Nf6 Bg2 d6 c3 b5 Nxd4 d6 h3 O-O Be2 Be7 O-O-O
[2025-04-02 06:09:44] e4 e5 d4 Bg7 c4 O-O Nbd2 Bg7 Be3 a6 O-O f5 Bd2 Nd7 Nf3 Bb7 Nf3 c6 Be3
[2025-04-02 06:09:45] Saved checkpoint at checkpoints/run_20250402_052242/regular/model_step_100.pt
[2025-04-02 06:10:12] step  101 | loss: 3.156069 | lr: 4.3005e-04 | norm: 0.2815 | dt: 27657.68ms | tok/sec: 9478.16
[2025-04-02 06:10:41] step  102 | loss: 3.155958 | lr: 4.2676e-04 | norm: 0.3027 | dt: 28319.68ms | tok/sec: 9256.60
[2025-04-02 06:11:09] step  103 | loss: 3.177737 | lr: 4.2345e-04 | norm: 0.3206 | dt: 28117.70ms | tok/sec: 9323.10
[2025-04-02 06:11:37] step  104 | loss: 3.167204 | lr: 4.2013e-04 | norm: 0.3159 | dt: 28256.87ms | tok/sec: 9277.18
[2025-04-02 06:12:05] step  105 | loss: 3.124800 | lr: 4.1679e-04 | norm: 0.3779 | dt: 27838.12ms | tok/sec: 9416.73
[2025-04-02 06:12:33] step  106 | loss: 3.176420 | lr: 4.1343e-04 | norm: 0.5039 | dt: 27938.92ms | tok/sec: 9382.75
[2025-04-02 06:13:00] step  107 | loss: 3.145416 | lr: 4.1007e-04 | norm: 0.5128 | dt: 27627.57ms | tok/sec: 9488.49
[2025-04-02 06:13:28] step  108 | loss: 3.135275 | lr: 4.0668e-04 | norm: 0.5137 | dt: 27980.71ms | tok/sec: 9368.74
[2025-04-02 06:13:57] step  109 | loss: 3.148720 | lr: 4.0329e-04 | norm: 0.4227 | dt: 28272.89ms | tok/sec: 9271.92
[2025-04-02 06:14:25] step  110 | loss: 3.161567 | lr: 3.9988e-04 | norm: 0.2279 | dt: 28050.94ms | tok/sec: 9345.28
[2025-04-02 06:14:53] step  111 | loss: 3.143690 | lr: 3.9646e-04 | norm: 0.3278 | dt: 27724.73ms | tok/sec: 9455.24
[2025-04-02 06:15:21] step  112 | loss: 3.108522 | lr: 3.9303e-04 | norm: 0.3822 | dt: 28123.58ms | tok/sec: 9321.15
[2025-04-02 06:15:48] step  113 | loss: 3.161462 | lr: 3.8959e-04 | norm: 0.2014 | dt: 27775.50ms | tok/sec: 9437.96
[2025-04-02 06:16:17] step  114 | loss: 3.099748 | lr: 3.8614e-04 | norm: 0.2174 | dt: 28346.82ms | tok/sec: 9247.74
[2025-04-02 06:16:45] step  115 | loss: 3.091508 | lr: 3.8267e-04 | norm: 0.4414 | dt: 27758.16ms | tok/sec: 9443.85
[2025-04-02 06:17:12] step  116 | loss: 3.144764 | lr: 3.7920e-04 | norm: 0.6702 | dt: 27669.99ms | tok/sec: 9473.95
[2025-04-02 06:17:40] step  117 | loss: 3.148062 | lr: 3.7572e-04 | norm: 0.6943 | dt: 27944.27ms | tok/sec: 9380.96
[2025-04-02 06:18:08] step  118 | loss: 3.086257 | lr: 3.7224e-04 | norm: 0.4721 | dt: 28265.54ms | tok/sec: 9274.33
[2025-04-02 06:18:37] step  119 | loss: 3.075327 | lr: 3.6874e-04 | norm: 0.2658 | dt: 28130.21ms | tok/sec: 9318.95
[2025-04-02 06:19:04] step  120 | loss: 3.110713 | lr: 3.6524e-04 | norm: 0.5378 | dt: 27564.06ms | tok/sec: 9510.36
[2025-04-02 06:19:32] step  121 | loss: 3.072991 | lr: 3.6174e-04 | norm: 0.4663 | dt: 27846.86ms | tok/sec: 9413.77
[2025-04-02 06:20:00] step  122 | loss: 3.137699 | lr: 3.5822e-04 | norm: 0.1687 | dt: 27754.93ms | tok/sec: 9444.95
[2025-04-02 06:20:28] step  123 | loss: 3.095367 | lr: 3.5471e-04 | norm: 0.5693 | dt: 27876.32ms | tok/sec: 9403.83
[2025-04-02 06:20:57] step  124 | loss: 3.060705 | lr: 3.5118e-04 | norm: 0.5945 | dt: 28988.35ms | tok/sec: 9043.08
[2025-04-02 06:21:25] step  125 | loss: 3.109430 | lr: 3.4766e-04 | norm: 0.2295 | dt: 28074.42ms | tok/sec: 9337.47
[2025-04-02 06:21:52] step  126 | loss: 3.026953 | lr: 3.4413e-04 | norm: 0.4816 | dt: 27746.13ms | tok/sec: 9447.95
[2025-04-02 06:22:20] step  127 | loss: 3.150563 | lr: 3.4060e-04 | norm: 0.5416 | dt: 27975.64ms | tok/sec: 9370.44
[2025-04-02 06:22:48] step  128 | loss: 3.057114 | lr: 3.3707e-04 | norm: 0.3750 | dt: 27999.34ms | tok/sec: 9362.51
[2025-04-02 06:23:16] step  129 | loss: 3.068865 | lr: 3.3353e-04 | norm: 0.7065 | dt: 27791.65ms | tok/sec: 9432.47
[2025-04-02 06:23:44] step  130 | loss: 3.073316 | lr: 3.3000e-04 | norm: 0.6019 | dt: 27816.49ms | tok/sec: 9424.05
[2025-04-02 06:24:12] step  131 | loss: 3.023905 | lr: 3.2647e-04 | norm: 0.4072 | dt: 27561.59ms | tok/sec: 9511.21
[2025-04-02 06:24:40] step  132 | loss: 3.116315 | lr: 3.2293e-04 | norm: 0.5740 | dt: 27913.76ms | tok/sec: 9391.21
[2025-04-02 06:25:07] step  133 | loss: 3.047871 | lr: 3.1940e-04 | norm: 0.3678 | dt: 27848.88ms | tok/sec: 9413.09
[2025-04-02 06:25:35] step  134 | loss: 3.047287 | lr: 3.1587e-04 | norm: 0.3223 | dt: 27930.91ms | tok/sec: 9385.45
[2025-04-02 06:26:03] step  135 | loss: 3.094627 | lr: 3.1234e-04 | norm: 0.5574 | dt: 27879.18ms | tok/sec: 9402.86
[2025-04-02 06:26:31] step  136 | loss: 3.137145 | lr: 3.0882e-04 | norm: 0.3453 | dt: 28210.98ms | tok/sec: 9292.27
[2025-04-02 06:26:59] step  137 | loss: 3.117697 | lr: 3.0529e-04 | norm: 0.6370 | dt: 27547.47ms | tok/sec: 9516.08
[2025-04-02 06:27:27] step  138 | loss: 3.088932 | lr: 3.0178e-04 | norm: 1.1233 | dt: 27864.13ms | tok/sec: 9407.94
[2025-04-02 06:27:54] step  139 | loss: 3.070287 | lr: 2.9826e-04 | norm: 0.8161 | dt: 27554.34ms | tok/sec: 9513.71
[2025-04-02 06:28:22] step  140 | loss: 3.079878 | lr: 2.9476e-04 | norm: 0.6708 | dt: 27784.56ms | tok/sec: 9434.88
[2025-04-02 06:28:50] step  141 | loss: 3.036583 | lr: 2.9126e-04 | norm: 0.6498 | dt: 27642.92ms | tok/sec: 9483.22
[2025-04-02 06:29:18] step  142 | loss: 3.007899 | lr: 2.8776e-04 | norm: 0.6571 | dt: 27860.91ms | tok/sec: 9409.02
[2025-04-02 06:29:46] step  143 | loss: 3.031152 | lr: 2.8428e-04 | norm: 0.6739 | dt: 27900.79ms | tok/sec: 9395.58
[2025-04-02 06:30:14] step  144 | loss: 3.060083 | lr: 2.8080e-04 | norm: 0.3895 | dt: 28199.78ms | tok/sec: 9295.96
[2025-04-02 06:30:41] step  145 | loss: 3.071744 | lr: 2.7733e-04 | norm: 0.6863 | dt: 27604.57ms | tok/sec: 9496.40
[2025-04-02 06:31:09] step  146 | loss: 3.066550 | lr: 2.7386e-04 | norm: 0.5257 | dt: 27130.68ms | tok/sec: 9662.27
[2025-04-02 06:31:36] step  147 | loss: 2.990706 | lr: 2.7041e-04 | norm: 0.4479 | dt: 27818.74ms | tok/sec: 9423.29
[2025-04-02 06:32:04] step  148 | loss: 2.980866 | lr: 2.6697e-04 | norm: 0.6495 | dt: 27720.97ms | tok/sec: 9456.52
[2025-04-02 06:32:35] step  149 | loss: 3.012928 | lr: 2.6354e-04 | norm: 0.1980 | dt: 31246.05ms | tok/sec: 8389.67
[2025-04-02 06:33:03] step  150 | loss: 3.058585 | lr: 2.6012e-04 | norm: 0.5836 | dt: 27470.80ms | tok/sec: 9542.64
[2025-04-02 06:33:31] step  151 | loss: 2.957827 | lr: 2.5671e-04 | norm: 0.3343 | dt: 27766.72ms | tok/sec: 9440.94
[2025-04-02 06:33:58] step  152 | loss: 3.041612 | lr: 2.5332e-04 | norm: 0.4306 | dt: 27594.17ms | tok/sec: 9499.98
[2025-04-02 06:34:26] step  153 | loss: 2.931701 | lr: 2.4993e-04 | norm: 0.4953 | dt: 27693.05ms | tok/sec: 9466.06
[2025-04-02 06:34:53] step  154 | loss: 3.007819 | lr: 2.4657e-04 | norm: 0.3162 | dt: 27570.07ms | tok/sec: 9508.28
[2025-04-02 06:35:22] step  155 | loss: 3.000463 | lr: 2.4321e-04 | norm: 0.5774 | dt: 28098.64ms | tok/sec: 9329.42
[2025-04-02 06:35:50] step  156 | loss: 3.025648 | lr: 2.3987e-04 | norm: 0.5104 | dt: 28651.10ms | tok/sec: 9149.53
[2025-04-02 06:36:18] step  157 | loss: 2.979093 | lr: 2.3655e-04 | norm: 0.5234 | dt: 27986.37ms | tok/sec: 9366.84
[2025-04-02 06:36:46] step  158 | loss: 3.036628 | lr: 2.3324e-04 | norm: 0.3404 | dt: 27680.61ms | tok/sec: 9470.31
[2025-04-02 06:37:13] step  159 | loss: 2.954592 | lr: 2.2995e-04 | norm: 0.3361 | dt: 27384.23ms | tok/sec: 9572.81
[2025-04-02 06:37:41] step  160 | loss: 3.048097 | lr: 2.2668e-04 | norm: 0.4887 | dt: 27503.59ms | tok/sec: 9531.27
[2025-04-02 06:38:08] step  161 | loss: 2.979650 | lr: 2.2342e-04 | norm: 0.4770 | dt: 27496.55ms | tok/sec: 9533.71
[2025-04-02 06:38:36] step  162 | loss: 2.981099 | lr: 2.2018e-04 | norm: 0.5033 | dt: 27894.78ms | tok/sec: 9397.60
[2025-04-02 06:39:04] step  163 | loss: 2.984687 | lr: 2.1696e-04 | norm: 0.5604 | dt: 27523.20ms | tok/sec: 9524.48
[2025-04-02 06:39:32] step  164 | loss: 3.004959 | lr: 2.1376e-04 | norm: 0.3671 | dt: 27772.38ms | tok/sec: 9439.02
[2025-04-02 06:39:59] step  165 | loss: 2.990539 | lr: 2.1058e-04 | norm: 0.4747 | dt: 27778.70ms | tok/sec: 9436.87
[2025-04-02 06:40:27] step  166 | loss: 3.009803 | lr: 2.0742e-04 | norm: 0.5073 | dt: 27915.35ms | tok/sec: 9390.68
[2025-04-02 06:40:55] step  167 | loss: 2.915314 | lr: 2.0428e-04 | norm: 0.2932 | dt: 27699.33ms | tok/sec: 9463.91
[2025-04-02 06:41:22] step  168 | loss: 2.994010 | lr: 2.0117e-04 | norm: 0.4098 | dt: 27224.19ms | tok/sec: 9629.08
[2025-04-02 06:41:49] step  169 | loss: 3.026656 | lr: 1.9807e-04 | norm: 0.5412 | dt: 27186.71ms | tok/sec: 9642.36
[2025-04-02 06:42:16] step  170 | loss: 2.921420 | lr: 1.9500e-04 | norm: 0.6777 | dt: 27126.85ms | tok/sec: 9663.63
[2025-04-02 06:42:44] step  171 | loss: 2.978816 | lr: 1.9195e-04 | norm: 1.1453 | dt: 27391.08ms | tok/sec: 9570.41
[2025-04-02 06:43:11] step  172 | loss: 2.944125 | lr: 1.8893e-04 | norm: 0.8416 | dt: 27511.45ms | tok/sec: 9528.54
[2025-04-02 06:43:39] step  173 | loss: 2.902158 | lr: 1.8592e-04 | norm: 0.4442 | dt: 28039.07ms | tok/sec: 9349.24
[2025-04-02 06:44:07] step  174 | loss: 2.948098 | lr: 1.8295e-04 | norm: 0.6653 | dt: 27564.07ms | tok/sec: 9510.35
[2025-04-02 06:44:35] step  175 | loss: 3.005761 | lr: 1.8000e-04 | norm: 0.8078 | dt: 27739.87ms | tok/sec: 9450.08
[2025-04-02 06:45:02] step  176 | loss: 2.974233 | lr: 1.7707e-04 | norm: 0.6146 | dt: 27389.55ms | tok/sec: 9570.95
[2025-04-02 06:45:30] step  177 | loss: 2.932218 | lr: 1.7417e-04 | norm: 0.4142 | dt: 28046.34ms | tok/sec: 9346.82
[2025-04-02 06:45:58] step  178 | loss: 2.890431 | lr: 1.7130e-04 | norm: 0.5486 | dt: 27769.41ms | tok/sec: 9440.03
[2025-04-02 06:46:26] step  179 | loss: 2.946506 | lr: 1.6845e-04 | norm: 0.4610 | dt: 28301.18ms | tok/sec: 9262.65
[2025-04-02 06:46:54] step  180 | loss: 2.914562 | lr: 1.6563e-04 | norm: 0.3818 | dt: 27617.28ms | tok/sec: 9492.03
[2025-04-02 06:47:22] step  181 | loss: 2.934703 | lr: 1.6284e-04 | norm: 0.3603 | dt: 27778.46ms | tok/sec: 9436.95
[2025-04-02 06:47:49] step  182 | loss: 2.934787 | lr: 1.6008e-04 | norm: 0.3582 | dt: 27525.74ms | tok/sec: 9523.60
[2025-04-02 06:48:17] step  183 | loss: 2.858843 | lr: 1.5735e-04 | norm: 0.3530 | dt: 27619.42ms | tok/sec: 9491.29
[2025-04-02 06:48:44] step  184 | loss: 2.983910 | lr: 1.5465e-04 | norm: 0.3472 | dt: 27536.64ms | tok/sec: 9519.83
[2025-04-02 06:49:12] step  185 | loss: 2.936097 | lr: 1.5198e-04 | norm: 0.3084 | dt: 27630.74ms | tok/sec: 9487.40
[2025-04-02 06:49:40] step  186 | loss: 2.940368 | lr: 1.4933e-04 | norm: 0.4259 | dt: 27787.12ms | tok/sec: 9434.01
[2025-04-02 06:50:07] step  187 | loss: 2.904344 | lr: 1.4672e-04 | norm: 0.5061 | dt: 27653.71ms | tok/sec: 9479.52
[2025-04-02 06:50:36] step  188 | loss: 2.933300 | lr: 1.4414e-04 | norm: 0.6237 | dt: 28577.68ms | tok/sec: 9173.03
[2025-04-02 06:51:04] step  189 | loss: 2.901684 | lr: 1.4160e-04 | norm: 0.5853 | dt: 28060.46ms | tok/sec: 9342.11
[2025-04-02 06:51:32] step  190 | loss: 2.953903 | lr: 1.3908e-04 | norm: 0.4227 | dt: 28057.84ms | tok/sec: 9342.99
[2025-04-02 06:52:00] step  191 | loss: 2.941912 | lr: 1.3660e-04 | norm: 0.2673 | dt: 28295.25ms | tok/sec: 9264.59
[2025-04-02 06:52:28] step  192 | loss: 2.931052 | lr: 1.3415e-04 | norm: 0.3795 | dt: 27854.75ms | tok/sec: 9411.10
[2025-04-02 06:52:56] step  193 | loss: 2.913039 | lr: 1.3173e-04 | norm: 0.4370 | dt: 27579.15ms | tok/sec: 9505.15
[2025-04-02 06:53:24] step  194 | loss: 2.865776 | lr: 1.2935e-04 | norm: 0.3477 | dt: 27725.76ms | tok/sec: 9454.89
[2025-04-02 06:53:53] step  195 | loss: 2.926347 | lr: 1.2700e-04 | norm: 0.2885 | dt: 29202.95ms | tok/sec: 8976.63
[2025-04-02 06:54:20] step  196 | loss: 2.877645 | lr: 1.2469e-04 | norm: 0.3816 | dt: 27655.72ms | tok/sec: 9478.83
[2025-04-02 06:54:48] step  197 | loss: 2.880812 | lr: 1.2241e-04 | norm: 0.3759 | dt: 27791.90ms | tok/sec: 9432.39
[2025-04-02 06:55:16] step  198 | loss: 2.907058 | lr: 1.2017e-04 | norm: 0.2718 | dt: 27872.91ms | tok/sec: 9404.97
[2025-04-02 06:55:44] step  199 | loss: 2.877779 | lr: 1.1796e-04 | norm: 0.3268 | dt: 27681.32ms | tok/sec: 9470.07
[2025-04-02 06:56:12] step  200 | loss: 2.912842 | lr: 1.1579e-04 | norm: 0.4468 | dt: 27765.47ms | tok/sec: 9441.37
[2025-04-02 06:56:12] Validation loss at step 200: 2.792328
[2025-04-02 06:56:12] New best model saved at checkpoints/run_20250402_052242/best/model_step_200.pt
[2025-04-02 06:56:13] Sample responses at step 200:
[2025-04-02 06:56:13] e4 e5 Bc4 Nc6 Bc4 Nf6 c5 d6 c3 d6 Bd3 Qb6 O-O Be7 O-O O-O f4 b5 f3
[2025-04-02 06:56:13] e4 e5 Nf3 g6 d4 b6 e5 Nd5 Be2 Nf6 O-O g6 Na3 Bd7 Qd2 Be6 Nf3 cxd4 cxd4
[2025-04-02 06:56:14] Saved checkpoint at checkpoints/run_20250402_052242/regular/model_step_200.pt
[2025-04-02 06:56:42] step  201 | loss: 2.868928 | lr: 1.1366e-04 | norm: 0.4192 | dt: 28027.82ms | tok/sec: 9352.99
[2025-04-02 06:57:09] step  202 | loss: 2.933948 | lr: 1.1157e-04 | norm: 0.3130 | dt: 27710.36ms | tok/sec: 9460.14
[2025-04-02 06:57:37] step  203 | loss: 2.837542 | lr: 1.0951e-04 | norm: 0.3545 | dt: 27717.18ms | tok/sec: 9457.82
[2025-04-02 06:58:05] step  204 | loss: 2.887658 | lr: 1.0749e-04 | norm: 0.4833 | dt: 27658.69ms | tok/sec: 9477.82
[2025-04-02 06:58:34] step  205 | loss: 2.910999 | lr: 1.0550e-04 | norm: 0.2868 | dt: 29427.73ms | tok/sec: 8908.06
[2025-04-02 06:59:02] step  206 | loss: 2.921030 | lr: 1.0356e-04 | norm: 0.3218 | dt: 27803.76ms | tok/sec: 9428.37
[2025-04-02 06:59:30] step  207 | loss: 2.908334 | lr: 1.0165e-04 | norm: 0.4551 | dt: 28082.80ms | tok/sec: 9334.68
[2025-04-02 06:59:58] step  208 | loss: 2.879500 | lr: 9.9787e-05 | norm: 0.3493 | dt: 27612.05ms | tok/sec: 9493.83
[2025-04-02 07:00:26] step  209 | loss: 2.842623 | lr: 9.7960e-05 | norm: 0.2523 | dt: 28458.82ms | tok/sec: 9211.34
[2025-04-02 07:00:54] step  210 | loss: 2.890121 | lr: 9.6173e-05 | norm: 0.3695 | dt: 28068.33ms | tok/sec: 9339.49
[2025-04-02 07:01:22] step  211 | loss: 2.847131 | lr: 9.4426e-05 | norm: 0.4085 | dt: 28179.70ms | tok/sec: 9302.58
[2025-04-02 07:01:50] step  212 | loss: 2.824873 | lr: 9.2719e-05 | norm: 0.1930 | dt: 27659.99ms | tok/sec: 9477.37
[2025-04-02 07:02:18] step  213 | loss: 2.855714 | lr: 9.1053e-05 | norm: 0.3253 | dt: 27898.35ms | tok/sec: 9396.40
[2025-04-02 07:02:46] step  214 | loss: 2.847090 | lr: 8.9428e-05 | norm: 0.3362 | dt: 27599.59ms | tok/sec: 9498.11
[2025-04-02 07:03:13] step  215 | loss: 2.805234 | lr: 8.7844e-05 | norm: 0.3888 | dt: 27493.65ms | tok/sec: 9534.71
[2025-04-02 07:03:41] step  216 | loss: 2.892640 | lr: 8.6302e-05 | norm: 0.3003 | dt: 28088.81ms | tok/sec: 9332.68
[2025-04-02 07:04:09] step  217 | loss: 2.860918 | lr: 8.4801e-05 | norm: 0.2699 | dt: 27638.78ms | tok/sec: 9484.65
[2025-04-02 07:04:37] step  218 | loss: 2.872650 | lr: 8.3343e-05 | norm: 0.2523 | dt: 27926.78ms | tok/sec: 9386.83
[2025-04-02 07:05:04] step  219 | loss: 2.836016 | lr: 8.1926e-05 | norm: 0.3173 | dt: 27579.26ms | tok/sec: 9505.11
[2025-04-02 07:05:32] step  220 | loss: 2.861743 | lr: 8.0553e-05 | norm: 0.4153 | dt: 27725.75ms | tok/sec: 9454.89
[2025-04-02 07:06:01] step  221 | loss: 2.864934 | lr: 7.9221e-05 | norm: 0.3403 | dt: 28792.48ms | tok/sec: 9104.60
[2025-04-02 07:06:29] step  222 | loss: 2.849221 | lr: 7.7933e-05 | norm: 0.3599 | dt: 28555.19ms | tok/sec: 9180.26
[2025-04-02 07:06:57] step  223 | loss: 2.848408 | lr: 7.6688e-05 | norm: 0.2413 | dt: 27743.15ms | tok/sec: 9448.96
[2025-04-02 07:07:26] step  224 | loss: 2.769247 | lr: 7.5487e-05 | norm: 0.3275 | dt: 28591.72ms | tok/sec: 9168.53
[2025-04-02 07:07:54] step  225 | loss: 2.770734 | lr: 7.4329e-05 | norm: 0.2853 | dt: 28335.89ms | tok/sec: 9251.31
[2025-04-02 07:08:22] step  226 | loss: 2.824244 | lr: 7.3215e-05 | norm: 0.2779 | dt: 27747.39ms | tok/sec: 9447.52
[2025-04-02 07:08:50] step  227 | loss: 2.866044 | lr: 7.2145e-05 | norm: 0.2415 | dt: 27730.89ms | tok/sec: 9453.14
[2025-04-02 07:09:18] step  228 | loss: 2.859780 | lr: 7.1119e-05 | norm: 0.3159 | dt: 27987.68ms | tok/sec: 9366.41
[2025-04-02 07:09:45] step  229 | loss: 2.847326 | lr: 7.0137e-05 | norm: 0.2234 | dt: 27706.73ms | tok/sec: 9461.38
[2025-04-02 07:10:13] step  230 | loss: 2.852903 | lr: 6.9200e-05 | norm: 0.2481 | dt: 27648.97ms | tok/sec: 9481.15
[2025-04-02 07:10:41] step  231 | loss: 2.825747 | lr: 6.8308e-05 | norm: 0.2337 | dt: 28209.56ms | tok/sec: 9292.74
[2025-04-02 07:11:09] step  232 | loss: 2.896026 | lr: 6.7460e-05 | norm: 0.2769 | dt: 28046.52ms | tok/sec: 9346.76
[2025-04-02 07:11:37] step  233 | loss: 2.878199 | lr: 6.6658e-05 | norm: 0.2941 | dt: 28101.04ms | tok/sec: 9328.62
[2025-04-02 07:12:05] step  234 | loss: 2.821059 | lr: 6.5900e-05 | norm: 0.2994 | dt: 27695.26ms | tok/sec: 9465.30
[2025-04-02 07:12:33] step  235 | loss: 2.793173 | lr: 6.5188e-05 | norm: 0.2245 | dt: 27782.95ms | tok/sec: 9435.43
[2025-04-02 07:13:00] step  236 | loss: 2.806318 | lr: 6.4521e-05 | norm: 0.2424 | dt: 27577.20ms | tok/sec: 9505.82
[2025-04-02 07:13:28] step  237 | loss: 2.854252 | lr: 6.3900e-05 | norm: 0.3368 | dt: 27778.30ms | tok/sec: 9437.01
[2025-04-02 07:13:57] step  238 | loss: 2.788830 | lr: 6.3324e-05 | norm: 0.3851 | dt: 28405.46ms | tok/sec: 9228.65
[2025-04-02 07:14:25] step  239 | loss: 2.839526 | lr: 6.2794e-05 | norm: 0.3533 | dt: 27987.25ms | tok/sec: 9366.55
[2025-04-02 07:14:52] step  240 | loss: 2.843992 | lr: 6.2310e-05 | norm: 0.3592 | dt: 27654.25ms | tok/sec: 9479.34
[2025-04-02 07:15:20] step  241 | loss: 2.836422 | lr: 6.1872e-05 | norm: 0.2822 | dt: 28075.33ms | tok/sec: 9337.17
[2025-04-02 07:15:48] step  242 | loss: 2.835300 | lr: 6.1479e-05 | norm: 0.3441 | dt: 27819.18ms | tok/sec: 9423.14
[2025-04-02 07:16:16] step  243 | loss: 2.819293 | lr: 6.1133e-05 | norm: 0.3950 | dt: 28159.23ms | tok/sec: 9309.35
[2025-04-02 07:16:44] step  244 | loss: 2.828849 | lr: 6.0832e-05 | norm: 0.2573 | dt: 27702.21ms | tok/sec: 9462.93
[2025-04-02 07:17:12] step  245 | loss: 2.851004 | lr: 6.0578e-05 | norm: 0.3198 | dt: 27728.26ms | tok/sec: 9454.04
[2025-04-02 07:17:40] step  246 | loss: 2.792482 | lr: 6.0370e-05 | norm: 0.4322 | dt: 27894.29ms | tok/sec: 9397.76
[2025-04-02 07:18:08] step  247 | loss: 2.815120 | lr: 6.0208e-05 | norm: 0.2203 | dt: 28148.00ms | tok/sec: 9313.06
[2025-04-02 07:18:36] step  248 | loss: 2.820294 | lr: 6.0093e-05 | norm: 0.3406 | dt: 27960.42ms | tok/sec: 9375.54
[2025-04-02 07:19:03] step  249 | loss: 2.813500 | lr: 6.0023e-05 | norm: 0.4953 | dt: 27606.98ms | tok/sec: 9495.57
[2025-04-02 07:19:04] Final model saved at checkpoints/run_20250402_052242/final/model_step_249.pt
